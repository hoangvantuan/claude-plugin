# Outline Rules

Quy tắc tạo outline cho ProSlide. Tuân thủ nghiêm ngặt khi tạo outline ở Step 2.

## Content Type → Framework Mapping

| Content Type       | Primary Framework              | Opening Pattern                                   | Body Pattern                                                                   | Closing Pattern                                  |
| ------------------ | ------------------------------ | ------------------------------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------ |
| Hướng dẫn/Giáo dục | Gagné's 9 Events + Scaffolding | Mục tiêu học → Recall kiến thức cũ → Hook câu hỏi | Concept scaffolding: simple→complex, Def→Example→Non-example, Knowledge checks | Tóm tắt + Bài tập thực hành + Tài liệu tham khảo |
| Business/Báo cáo   | Pyramid Principle              | Kết luận/Đề xuất trước → Context                  | Top-down: Recommendation → 3 supporting args → Data evidence                   | Key takeaways + Next steps + Decision needed     |
| Thuyết phục/Pitch  | PAS + Sparkline (Duarte)       | Problem hook → Agitate (amplify pain)             | What IS vs What COULD BE oscillation, social proof, benefits                   | Strong CTA + Urgency + Contact                   |
| Technical/Process  | SCR + Step-by-step             | Situation → Complication → Why solve now          | Sequential steps, comparison tables, architecture flow, cause-effect           | Summary + Implementation roadmap + Resources     |

### Gagné's 9 Events (Hướng dẫn/Giáo dục)

1. Gain attention (hook/câu hỏi mở)
2. Inform objectives (slide mục tiêu)
3. Stimulate recall (kết nối kiến thức cũ)
4. Present content (nội dung chính, scaffolding)
5. Provide guidance (ví dụ, analogy, mental models)
6. Elicit performance (câu hỏi kiểm tra/bài tập)
7. Provide feedback (đáp án/giải thích)
8. Assess performance (quiz tổng hợp)
9. Enhance retention (tóm tắt + tài liệu + call to practice)

### Educational Slide Patterns

* Definition → Example → Non-example

* Analogy/Metaphor: giải thích phức tạp bằng so sánh quen thuộc

* Before/After comparison

* Misconception: "Nhiều người nghĩ X, thực tế là Y"

* Knowledge check: câu hỏi reflection giữa sections

* Vietnamese pattern: Mục tiêu → Nội dung → Ví dụ → Bài tập → Tóm tắt

## Cấu trúc bắt buộc: Opening > Body > Closing

### Opening (2-3 slides)

* **Slide 1** `[title]`: Main title (assertion, not topic) + subtitle/tagline + presenter info (optional)

* **Slide 2** `[content]`: Hook/Problem - dùng 1 pattern: Statistic hook, Problem statement, Provocative question, Personal story opener. Mục đích: establish WHY audience should care (SCR: Situation > Complication)

* **Slide 3** `[agenda]` (optional, L2/L3 only): Numbered list of sections (max 5 items), giúp audience track progress

### Body (N slides, depends on level)

* Mỗi slide = 1 key point (KHÔNG BAO GIỜ 2+ concepts/slide)

* Slide title = full sentence assertion (Assertion-Evidence), KHÔNG phải topic label

  * SAI: "Phân Tích Thị Trường"

  * ĐÚNG: "Thị trường Gen Z tăng trưởng 25%/năm, cơ hội lớn nhất trong 5 năm"

* Logic flow: Pyramid Principle - conclusion/recommendation first > 3 supporting arguments > data/evidence

* Rule of Three: nhóm content theo cụm 3 (3 sections, 3 points/section, 3 examples max)

* Transition slides giữa major sections (simple section title + progress indicator "Part X of Y")

* **Statement slides**: Dùng cho key insights, bold assertions, memorable quotes. 1 câu assertion lớn (40-48pt), centered. Xen kẽ trong body để tạo visual rhythm

* **Metric slides**: Dùng cho key data points, KPIs, statistics. 1 số liệu lớn (60-72pt) + label + brief context

* **Visual Rhythm Rule**: Max 4 content slides liên tiếp. Sau mỗi 3-4 content slides, PHẢI xen 1 slide khác loại (transition, statement, metric, hoặc comparison). Áp dụng cho tất cả levels

* Content per level:

  * **L1**: 2-3 bullets, <8 words/bullet, font 22-24pt, action verbs, no sub-bullets. 30-40% body slides PHẢI là statement hoặc metric type

  * **L2**: 3-5 bullets + 1-2 sub-bullets bắt buộc, moderate detail, examples inline, code snippets

  * **L3**: 3-5 main bullets + 2-3 sub-bullets, detailed explanations, data points, full examples, max 60-100 words/slide

### Closing (1-2 slides)

* **Slide N-1** `[summary]`: Key Takeaways - max 3 points (Rule of Three), use checkmarks, summarize actionable insights

* **Slide N** `[cta]`: Call to Action - CTA mở (encourage exploration/practice). Patterns: "Let's discuss", next steps, contact info. Hoặc Circular Callback (tie back to opening hook)

## Quy tắc nội dung

* **Bullet points**: 3-5 max/slide, parallel grammatical structure, start with action verbs, <8 words each (L1) or <12 words (L2/L3)

* **6-second rule**: audience phải hiểu slide trong <6 giây scan (L1/L2), <15 giây (L3)

* **Information hierarchy**: Primary (title, 36-44pt) > Secondary (bullets, 24-32pt) > Tertiary (notes, 14-16pt)

* **Content compression**: target 10:1 ratio (L1), 3:1 (L2), 2:1 (L3)

* **Remove filler**: no "As you can see", "It's important to note", qualifiers ("very", "quite")

* **Use specific data**: "Revenue up 45%" not "Significant growth"

* **Cognitive load**: max 3-4 new concepts per slide. Words target: 15-25 (L1), 30-60 (L2), 60-100 (L3). Split slide nếu cần >90 giây để giải thích

## Slide Types

| Type         | Mô tả                                                  | Layout                           |
| ------------ | ------------------------------------------------------ | -------------------------------- |
| `title`      | Main title + subtitle, centered                        | Center aligned, vertical center  |
| `agenda`     | Numbered list of sections                              | Left aligned, after title slide  |
| `content`    | Single message, bullet list, definition, process steps | Left aligned, title top          |
| `comparison` | Two-column layout, before/after, A vs B                | Two columns with divider         |
| `summary`    | Key takeaways with checkmarks, 3 points max            | Left aligned with check icons    |
| `cta`        | Call to action, action statement + contact             | Center aligned                   |
| `transition` | Section divider, title + progress indicator            | Center aligned, light bg         |
| `statement`  | 1 assertion/quote lớn, centered, full slide            | Center aligned, large text       |
| `metric`     | 1 số liệu lớn + label + context, centered              | Center aligned, oversized number |

## Detail Level Mapping

| Aspect        | L1 (Tổng quan)                        | L2 (Cân bằng)                                | L3 (Chi tiết)                              |
| ------------- | ------------------------------------- | -------------------------------------------- | ------------------------------------------ |
| Slides        | 5+ (tùy nội dung)                     | 10+ (tùy nội dung)                           | 18+ (tùy nội dung)                         |
| Words/slide   | 10-20                                 | 30-60                                        | 60-100                                     |
| Bullets/slide | 2-3, <8 words/bullet, font 22-24pt    | 3-5 + 1-2 sub-bullets mỗi bullet             | 3-5 + 2-3 sub-bullets mỗi bullet           |
| Compression   | 15:1                                  | 3:1                                          | 2:1                                        |
| Statement %   | 30-40% body slides = statement/metric | 10-20% body slides (optional)                | 5-10% body slides (optional)               |
| Examples      | None (hoặc 1 đại diện nếu Giáo dục)   | 1 ví dụ cụ thể mỗi concept chính             | Tất cả ví dụ relevant, format cho slide    |
| Code/Config   | None                                  | Trích đoạn code ngắn cho concepts quan trọng | Code examples đầy đủ, max 10-15 dòng/slide |
| Data points   | Key metrics → metric slides           | Moderate + so sánh                           | Comprehensive, dùng bảng/list có cấu trúc  |
| Opening       | Title + Hook (2)                      | Title + Hook + Agenda (3)                    | Title + Hook + Agenda (3)                  |
| Closing       | Takeaways (max 2 points) (1)          | Takeaways + CTA (2)                          | Takeaways + CTA (2)                        |
| Transitions   | None (dùng statement/metric thay thế) | Between major sections                       | Between major sections only                |

### L1 Content Selection Criteria

Khi tạo outline L1, tuân thủ quy tắc sau. L1 = **executive presentation**, cần visual impact cao, ít text, nhiều white space:

* **Max 2-3 bullets per slide** (không phải 3-5), font size 22-24pt (lớn hơn body thông thường)

* **30-40% slides trong body = statement hoặc metric type** (không phải toàn bullet list). Dùng statement cho key insights, metric cho data points quan trọng

* **Chỉ giữ**: Thesis statement / kết luận chính của mỗi section (1 bullet = 1 section)

* **Chỉ giữ**: Số liệu/metric quan trọng nhất → ưu tiên tạo metric slide thay vì bullet

* **Bỏ tất cả**: Giải thích, ví dụ, edge cases, chi tiết cấu hình, code

* **Ngoại lệ ví dụ**: Nếu content type = Giáo dục, cho phép 1 ví dụ đại diện per section

* **Gộp section nhỏ**: Nếu sections liên quan và ngắn, có thể gộp vào 1 slide

* **Bullet style**: Mỗi bullet là 1 assertion ngắn, bắt đầu bằng action verb, <8 words

* **Title slide**: title\_size lớn hơn (dùng giá trị từ style YAML), tạo ấn tượng mạnh

* **Takeaway slide**: Max 2 points (không phải 3), text lớn hơn để dễ đọc từ xa

### L2 Content Selection Criteria

Khi tạo outline L2, tuân thủ quy tắc sau để đảm bảo đủ chi tiết:

* **Giữ lại**: Mỗi concept chính PHẢI có ít nhất 1 ví dụ cụ thể hoặc code snippet minh họa

* **Giữ lại**: Thông tin cấu hình, parameters, options - liệt kê với giải thích ngắn

* **Giữ lại**: So sánh/phân biệt giữa các options (VD: foreground vs background, scope levels)

* **Giữ lại**: Workflow steps với chi tiết đủ để follow (không chỉ tên bước)

* **Bỏ qua**: Lời giải thích dài dòng, lặp lại

* **Bỏ qua**: Edge cases hiếm gặp, caveats nhỏ

* **Tách slide**: Nếu 1 topic có >5 sub-items, tách thành 2 slides thay vì nén vào 1

* **Sub-bullets bắt buộc**: Mỗi main bullet PHẢI có ít nhất 1 sub-bullet giải thích hoặc ví dụ

### L3 Content Selection Criteria

Khi tạo outline L3, tuân thủ quy tắc sau để đảm bảo chi tiết nhưng vẫn là presentation (không phải document dump):

* **Giữ tất cả**: Concepts, ví dụ, code snippets, parameters, options, comparisons, workflows

* **Format cho slide**: Code examples max 10-15 dòng/slide, nếu dài hơn thì tách thành nhiều slides

* **Số slides theo nội dung**: Tạo đủ slides để cover tất cả concepts, không giới hạn trần

* **Words/slide cap**: Tối đa 100 words/slide. Nếu vượt, tách thành 2 slides

* **Sub-bullets bắt buộc**: Mỗi main bullet PHẢI có 2-3 sub-bullets với giải thích chi tiết

* **Data/metrics**: Dùng bảng so sánh hoặc structured list, KHÔNG dump raw data

* **Tách section lớn**: Nếu 1 section source có >10 sub-topics, tách thành 2-3 slides với transition

* **Mỗi slide vẫn = 1 concept**: Dù chi tiết, vẫn giữ nguyên tắc 1 slide = 1 key point

* **Transitions**: Thêm transition slide giữa major sections only (không giữa sub-sections, tránh loãng nội dung)

## Content Map Rules

Trước khi tạo outline, BẮT BUỘC tạo Content Map từ source material. Content Map là danh sách topics được extract và xếp hạng, giúp đảm bảo outline không bỏ sót ý quan trọng.

### Process

1. **Parse source**: Chia source thành sections dựa trên headings, paragraph breaks, topic shifts
2. **Extract**: Với mỗi section, ghi nhận:

   * Topic name (tên ngắn gọn)

   * Key concepts (khái niệm chính)

   * Key data (số liệu, metrics, examples đáng chú ý)
3. **Rank priority** theo detail level đã chọn (xem bảng dưới)
4. **Giữ Content Map trong context** (KHÔNG show cho user), dùng làm checklist khi tạo outline

### Priority Assignment Rules

| Priority | L1                                            | L2                                               | L3                                     |
| -------- | --------------------------------------------- | ------------------------------------------------ | -------------------------------------- |
| `must`   | Thesis/kết luận chính, key metrics quyết định | Thesis + arguments + 1 example mỗi concept chính | Tất cả concepts + examples + code      |
| `should` | Supporting arguments, secondary metrics       | Additional examples, comparisons, config details | Edge cases, advanced details           |
| `nice`   | Examples, explanations, details               | Edge cases, caveats nhỏ                          | References, footnotes, tangential info |

### Coverage Thresholds

* **L1**: ≥ 100% `must` topics phải xuất hiện trong outline

* **L2**: ≥ 100% `must` + ≥ 70% `should` topics

* **L3**: ≥ 100% `must` + ≥ 90% `should` + best-effort `nice` topics

### Content Map Format (internal)

```
=== CONTENT MAP ===
1. [must] Topic name — key concept A, metric B
2. [must] Topic name — concept C, example D
3. [should] Topic name — comparison X vs Y
4. [should] Topic name — config detail Z
5. [nice] Topic name — edge case W
6. [R][should] Researched topic — statistic from web (Source: url)
7. [R][nice] Researched example — case study (Source: url)
=== END CONTENT MAP ===
```

**Tag `[R]` (Researched):** Items có prefix `[R]` là thông tin bổ sung từ web research (Step 1.5), không có trong source gốc. Quy tắc:
- `[R]` items vẫn phải gán priority (`must`/`should`/`nice`) theo tiêu chí bình thường
- `[R]` items KHÔNG được gán `must` trừ khi source gốc thiếu data critical cho topic chính
- Thông thường `[R]` items là `should` hoặc `nice`
- Max 10 `[R]` items trong 1 Content Map (tránh overwhelming source gốc)
- Coverage Report phải phân biệt source gốc vs researched items

## Coverage Report Rules

Sau khi tạo outline, BẮT BUỘC generate Coverage Report dạng file .md tách riêng. File lưu tại `{output_folder}/coverage-report.md`.

### Coverage Report Format

```markdown
# Coverage Report — [Tên presentation]

## Tổng quan
- **Source**: [tên file hoặc mô tả input]
- **Detail level**: L[x]
- **Topics trong source**: [N]
- **Topics covered**: [M] ([percentage]%)
- **Topics omitted**: [K]

## Source → Slide Mapping

| # | Source Topic | Priority | Slide(s) | Status |
|---|---|---|---|---|
| 1 | Topic A | must | 3, 4 | ✅ Covered |
| 2 | Topic B | must | 5 | ✅ Covered |
| 3 | Topic C | should | 6 | ✅ Merged with Topic B |
| 4 | Topic D | should | — | ⚠️ Omitted |
| 5 | Topic E | nice | — | ➖ Skipped (L2) |
| 6 | [R] Researched stat | should | 7 | ✅ Covered (research) |
| 7 | [R] Researched example | nice | — | ➖ Skipped (L2) |

## Omitted Topics & Justification

| Topic | Priority | Lý do bỏ |
|---|---|---|
| Topic D | should | Trùng lặp nội dung với Topic B (slide 5) |
| Topic E | nice | Edge case, vượt scope L2 |

## Key Data Check
- ✅ [Metric/data point] → slide [N]
- ✅ [Example] → slide [N]
- ⚠️ [Table/data] → simplified thành bullets (slide [N])
```

### Report Rules

* Mọi topic trong Content Map PHẢI xuất hiện trong report (covered hoặc omitted)

* Mọi topic omitted PHẢI có justification (lý do cụ thể, không generic)

* Justification hợp lệ: "trùng lặp với Topic X", "vượt scope L\[n]", "gộp vào slide \[N]", "quá chi tiết/edge case cho level này"

* Justification KHÔNG hợp lệ: "không quan trọng", "bỏ qua", "không cần thiết" (quá chung chung)

* Nếu coverage < threshold (xem Coverage Thresholds), PHẢI thêm topics vào outline cho đến khi đạt threshold

## Outline File Format (outline.md)

Khi lưu outline ra file, BẮT BUỘC có metadata header ở đầu file. Metadata cho phép reuse outline mà không cần hỏi lại config.

```markdown
---
title: "Tên presentation"
slug: "ten-presentation"
content_type: "Hướng dẫn/Giáo dục" | "Business/Báo cáo" | "Thuyết phục/Pitch" | "Technical/Process"
detail_level: "L1" | "L2" | "L3"
language: "vi" | "en" | "bilingual"
source: "mô tả ngắn source input (VD: file.md, user input text)"
created: "YYYY-MM-DD HH:mm"
total_slides: N
---

[Outline content theo format bên dưới]
```

**Metadata fields:**

* `title`: Tên chính của presentation

* `slug`: kebab-case dùng cho file naming

* `content_type`: Loại nội dung đã chọn ở Step 1

* `detail_level`: Mức chi tiết (L1/L2/L3) — outline gắn cố định với level này

* `language`: Ngôn ngữ: `vi` (Tiếng Việt), `en` (English), `bilingual` (Song ngữ)

* `source`: Mô tả source input gốc

* `created`: Timestamp tạo outline

* `total_slides`: Tổng số slides trong outline

## Outline Display Format

Outline hiển thị cho user PHẢI theo format phù hợp với level. **L2/L3 bắt buộc show sub-bullets. L1 chỉ flat bullets.**

### L1 Format Example

```
=== OUTLINE (L1) ===

[Opening]
1. [title] Title chính
   Subtitle ngắn gọn
2. [content] Hook/Problem statement
   1 câu mô tả hook

[Body]
3. [content] Assertion sentence (section gộp)
   - Bullet ngắn <8 words
   - Bullet ngắn <8 words
   - Bullet ngắn <8 words
4. [content] Assertion sentence
   - Bullet ngắn
   - Bullet ngắn
   - Bullet ngắn

[Closing]
N. [summary] Key Takeaways
   - Point 1
   - Point 2
   - Point 3

=== END OUTLINE ===
```

### L2/L3 Format Example

```
=== OUTLINE (L2/L3) ===

[Opening]
1. [title] Title chính của presentation
   Subtitle mô tả
2. [content] Hook/Problem statement
   Brief description of hook content
3. [agenda] Agenda
   List of sections

[Body - Section 1: Tên section]
4. [content] Assertion sentence as title
   - Main bullet 1
     · Sub-detail hoặc ví dụ
   - Main bullet 2
     · Sub-detail hoặc ví dụ
   - Main bullet 3
     · Sub-detail
5. [content] Next assertion
   - Main bullet with detail
     · Code example hoặc config snippet
   - Main bullet 2
     · Giải thích ngắn

[Body - Section 2: Tên section]
6. [transition] Section divider
7. [comparison] So sánh A vs B
   Left: Option A - key characteristics
   Right: Option B - key characteristics

[Closing]
N. [summary] Key Takeaways
   - Point 1
   - Point 2
   - Point 3
N+1. [cta] Call to Action
   Action description

=== END OUTLINE ===
```

## Code Slide Guidelines (L2/L3)

Khi outline chứa code snippets (L2/L3), tuân thủ:

* **Font**: Dùng `fonts.code` từ style YAML (fallback Arial vì monospace fonts không Vietnamese-safe)

* **Size**: `fonts.code_size` (default 14pt), nhỏ hơn body text để fit nhiều dòng hơn

* **Max lines**: 10-15 dòng code/slide. Nếu dài hơn → tách thành nhiều slides

* **Background**: Dùng `slide_styles.code.code_bg` để phân biệt code block với text

* **Slide structure**: Title (giải thích code làm gì) + code block + optional 1-2 bullet giải thích key points

* **Không mix**: Không trộn code block với bullet list dài trong cùng 1 slide. Chọn 1: code hoặc bullets

